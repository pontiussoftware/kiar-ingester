<h1 mat-dialog-title i18n="@@HeadingCreateInstitution">Create Institution</h1>
<div mat-dialog-content>
  <form [formGroup]="formControl">
    <mat-form-field appearance="fill" [style.width]="'50%'">
      <mat-label i18n="@@LabelName">Name</mat-label>
      <input matInput type="text" formControlName="name">
      @if (formControl.get('name')?.hasError('minlength')) {
        <mat-error>Minimum length is 10.</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="fill" [style.width]="'20%'">
      <mat-label i18n="@@LabelParticipant">Participant</mat-label>
      <mat-select formControlName="participantName">
        @for (participant of (participants | async); track participant) {
          <mat-option [value]="participant">
            {{ participant }}
          </mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill" [style.width]="'20%'">
      <mat-label i18n="@@LabelCanton">Canton</mat-label>
      <mat-select formControlName="canton">
        @for (canton of (cantons | async); track canton) {
          <mat-option [value]="canton.longName">
            {{ canton.longName }}
          </mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-checkbox formControlName="publish" i18n="@@LabelPublish">
            Publish
        </mat-checkbox>

    <mat-form-field appearance="fill" [style.width]="'100%'">
      <mat-label i18n="@@LabelDisplayName">Display Name</mat-label>
      <input matInput type="text" formControlName="displayName">
      @if (formControl.get('displayName')?.hasError('minlength')) {
        <mat-error>Minimum length is 10.</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="fill" [style.width]="'100%'">
      <mat-label i18n="@@LabelDescription">Description</mat-label>
      <textarea matInput formControlName="description"></textarea>
    </mat-form-field>

    <mat-tab-group [style.width]="'100%'">
      <mat-tab label="Contact" i18n-label="@@LabelContact">
        <mat-form-field appearance="fill" [style.width]="'50%'">
          <mat-label i18n="@@LabelStreet">Street</mat-label>
          <input matInput formControlName="street">
        </mat-form-field>

        <mat-form-field appearance="fill" [style.width]="'10%'">
          <mat-label i18n="@@LabelZip">Zip</mat-label>
          <input matInput type="number" formControlName="zip">
        </mat-form-field>

        <mat-form-field appearance="fill" [style.width]="'20%'">
          <mat-label i18n="@@LabelCity">City</mat-label>
          <input matInput formControlName="city">
        </mat-form-field>


        <mat-form-field appearance="fill" [style.width]="'10%'">
          <mat-label i18n="@@LabelCity">Longitude</mat-label>
          <input matInput formControlName="longitude" type="number">
        </mat-form-field>

        <mat-form-field appearance="fill" [style.width]="'10%'">
          <mat-label i18n="@@LabelCity">Latitude</mat-label>
          <input matInput formControlName="latitude" type="number">
        </mat-form-field>

        <mat-form-field appearance="fill" [style.width]="'50%'">
          <mat-label i18n="@@LabelEmail">E-Mail</mat-label>
          <input matInput type="email" formControlName="email">
          @if (formControl.get('email')?.hasError('email')) {
            <mat-error>Must be a valid e-mail address.
            </mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="fill" [style.width]="'50%'">
          <mat-label i18n="@@LabelHomepage">Homepage</mat-label>
          <input matInput type="url" formControlName="homepage">
        </mat-form-field>
      </mat-tab>
      <mat-tab label="Publication Defaults" i18n-label="@@LabelPublicationDefaults">
        <mat-form-field appearance="fill" [style.width]="'30%'">
          <mat-label i18n="@@LabelDefaultRightStatement">Default Right Statement</mat-label>
          <mat-select formControlName="defaultRightStatement">
            @for (rightStatement of (rightStatements | async); track rightStatement) {
              <mat-option
                [value]="rightStatement.shortName">
                {{ rightStatement.longName }}
              </mat-option>
            }
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="fill" [style.width]="'70%'">
          <mat-label i18n="@@LabelDefaultCopyright">Default Copyright</mat-label>
          <input matInput type="text" formControlName="defaultCopyright">
        </mat-form-field>

        <mat-form-field appearance="fill" [style.width]="'100%'">
          <mat-label i18n="@@LabelDefaultObjectUrl">Default Object URL</mat-label>
          <input matInput type="text" formControlName="defaultObjectUrl">
        </mat-form-field>
      </mat-tab>

      <!-- Tab of available collections (admin only).  -->
      <mat-tab label="Available Collections" i18n-label="@@LabelAvailableCollections">
        <ul formArrayName="availableCollections" class="checkbox-list">
          @for (option of availableCollectionsForms; track option; let i = $index) {
            <li>
              <mat-checkbox [formControl]="option">
                {{ allCollections[i].displayName }}
              </mat-checkbox>
            </li>
          }
        </ul>
      </mat-tab>

      <!-- Tab of selected collections -->
      <mat-tab label="Published Collections" i18n-label="@@LabelPublishedCollections">
        <ul formArrayName="selectedCollections" class="checkbox-list">
          @for (option of selectedCollectionsForms; track option; let i = $index) {
            <li>
              <mat-checkbox [formControl]="option">
                {{ availableCollections[i].displayName }}
              </mat-checkbox>
            </li>
          }
        </ul>
      </mat-tab>
    </mat-tab-group>
  </form>
</div>
<div mat-dialog-actions>
  <button mat-button color="primary" (click)="save()">
    <mat-icon>save</mat-icon>
    Save
  </button>

  @if (institutionId) {
    <button mat-button (click)="uploadImage()">
      <mat-icon>upload</mat-icon>
      Upload Image
    </button>
  }
</div>